import line from './line';
import rect from './rect';
import polygon from './polygon';

const handler = { line, rect, polygon };

export default {
  register(vueInstance, doc, draw, options) {
    const h = handler[options.type];
    if (!h) return;

    h.init();
    if (h.mouseDown)
      doc.onmousedown = event => {
        const res = h.mouseDown(event, draw, options);
        this.checkCreation(vueInstance, res);
      };
    if (h.dblClick)
      doc.ondblclick = () => {
        const res = h.dblClick(draw, options);
        this.checkCreation(vueInstance, res);
      };
    if (h.mouseMove)
      doc.onmousemove = h.mouseMove;
  },

  checkCreation(vueInstance, svgElement) {
    if (svgElement) {
      vueInstance.$emit('dataChange');
    };
  },

  line,
  rect,
  polygon,
};